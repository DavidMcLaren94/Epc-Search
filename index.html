<script>
  const supabase = window.supabase.createClient(
    'https://ngnfjsctegbwuwekbepf.supabase.co',
    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5nbmZqc2N0ZWdid3V3ZWtiZXBmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg5NDEzNjUsImV4cCI6MjA2NDUxNzM2NX0.meNo8toKu7jtfDmYTZdT-CnkuMRg55Gu33hR89VgvLY'
  );

  document.getElementById('searchBtn').onclick = async function() {
    const postcodeInput = document.getElementById('postcode').value.trim().toUpperCase();
    document.getElementById('result').textContent = 'Searching...';

    let { data, error } = await supabase
      .from('epc_certificates')
      .select('*')
      .eq('POSTCODE', postcodeInput);

    if (error) {
      document.getElementById('result').textContent = 'Supabase Error: ' + error.message;
      console.error(error);
      return;
    }

    if (!data || data.length === 0) {
      document.getElementById('result').textContent = 'No EPC data found for this postcode.';
      return;
    }

    document.getElementById('result').innerHTML = '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
  };
</script>
